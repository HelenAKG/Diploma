# Практическая часть выпускной квалификационной работы по курсу "Data Science"
                                         
### Тема                    
Прогнозирование конечных свойств новых материалов (композиционных материалов).                                   
                                               
### Описание                                     
Композиционные материалы — это искусственно созданные материалы, состоящие из нескольких других с четкой границей между ними. Композиты обладают теми свойствами, которые не наблюдаются у компонентов по отдельности. При этом композиты являются монолитным материалом, т. е. компоненты материала неотделимы друг от друга без разрушения конструкции в целом. Современные
композиты изготавливаются из таких материалов как полимеры, керамика, стеклянные и углеродные волокна.                               
У такого подхода есть недостаток: даже если мы знаем характеристики исходных компонентов, определить характеристики композита, состоящего из этих компонентов, достаточно проблематично.                                      
Для решения этой проблемы есть два пути: физические испытания образцов материалов, или прогнозирование характеристик. Суть прогнозирования заключается в симуляции представительного элемента объема композита, на основе данных о характеристиках входящих компонентов (связующего и армирующего компонента).                        
                                   
### Задача                                                          
Имеются данные о начальных свойствах компонентов композиционных материалов (количество связующего, наполнителя, температурный режим отверждения и т.д.). Необходимо спрогнозировать ряд конечных свойств получаемых композиционных материалов.                     
                                  
### Актуальность                                    
Созданные прогнозные модели помогут сократить количество проводимых испытаний, а также пополнить базу данных материалов возможными новыми характеристиками материалов, и цифровыми двойниками новых композитов. Кейс основан на реальных производственных задачах Центра НТИ «Цифровое материаловедение: новые материалы и вещества» (структурное подразделение МГТУ им. Н.Э. Баумана).
                                      
### Данные                                                                  
Данные представлены в двух датасетах.                          
Один датасет содержит следующие признаки:                     
- Соотношение матрица-наполнитель 
- Плотность, кг/м3
- модуль упругости, ГПа 
- Количество отвердителя, м.% 
- Содержание эпоксидных групп,%_2 
- Температура вспышки, С_2
- Поверхностная плотность, г/м2
- Модуль упругости при растяжении, ГПа
- Прочность при растяжении, МПа
- Потребление смолы, г/м2
Во втором датасете содердатся признаки:
- Угол нашивки, град  
- Шаг нашивки 
- Плотность нашивки
Объединение датасетов выполнено по индексу, тип объединения INNER. Объединенный датасет содержит 1023 записей, пропусков в данных нет.                               
                                  
### Метрики                        
В данной задаче регрессии мы отслеживаем следующие метрики:                            
- MSE (mean squared error, средняя квадратическая ошибка) - для каждой точки вычисляется квадратная разница между прогнозами и целью, а затем усредняются эти значения, чувствителен к выбросам (чем ближе к нулю, тем модель лучше)
- MAE (mean absolute error, средняя абсолютная ошибка) -  линейная оценка, которая означает, что все индивидуальные различия взвешены одинаково в среднем, менее чувствителен к выбросам, чем MSE (чем ближе к нулю, тем модель лучше)
- MAPE (mean percentage absolute error, средняя абсолютная ошибка в процентах) - показывает, на сколько процентов ошибается модель в предсказании (чем ближе к нулю, тем модель лучше)
- R2 (коэффициент детерминации или доля объяснённой дисперсии) - характеризует степень сходства исходных данных и предсказанных,  (чем ближе к единице, тем модель лучше, отрицательное R2 означает, что модель хуже, чем предсказание среднего значения)

### Выполнено                                  
- Разведочный анализ (найдены статистические показатели, проведен анализ и исключение выбросов по каждому из признаков);
- Визуализация (представлены гистограммы распределения каждой из переменной, диаграммы ящика с усами, попарные графики рассеяния точек, а также построена тепловая матрица взаимной корреляции признаков);
- Train Test Split (на тестовую выборку отведены 30% из набора данных, для воспроизводимости результата зафиксирован параметр random_state);
- Нормализация фичей выполнена с помощью MinMaxScaler, целевые признаки масштабированы путем деления на максимум;
- Machine learning - проведен поиск гиперпараметров модели с помощью поиска по сетке с перекрестной проверкой по каждому из алгоритмов:                                             
        1)  RandomForestRegressor 
        2)  Регрессионное Lasso для множественного вывода (MultiTaskLassoCV)                                     
        2)  CatBoostRegressor                                    
        3)  Xgboost                                            
- Deep Learning - построена нейронная сеть на TensorFlow для решения задачи регрессии с использованием полносвязных слоев, функция активации на выходном слое sigmoid.
- Разработка веб-приложения для автоматизации работы модели машинного обучения.

### Результаты
В предсказании признаков "Модуль упругости при растяжении, ГПа" и "Прочность при растяжении, МПа" с помощью инструментов ML получены следующие результаты:                                       

"Модуль упругости при растяжении, ГПа"                                 
                                              
|       model   |       MSE     |       MAE     |       MAPE    |       R2      |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|                                       
|       RandomForestRegressor    |       8.70    |       2.39    |       0.03    |       0.00   |                    
|       MultiTaskLassoCV    |       8.77    |       2.40    |       0.03    |       -0.01       |                                 
|       CatBoostRegressor    |       8.92    |       2.42    |       0.03    |       -0.02      |                     
|       Xgboost    |       9.02    |       2.41    |       0.03    |       -0.03        |                        
|       Blend_mean    |       8.69    |       2.38    |       0.03    |       0.00      |
                                         
                                      
"Прочность при растяжении, МПа"                                    
                                                                       
|       model    |       MSE    |       MAE    |       MAPE    |       R2       |
|:--------------:|:------------:|:------------:|:-------------:|:--------------:|                                         
|       RandomForestRegressor    |       213083.15    |       366.08    |       0.15    |       -0.04   |    
|       MultiTaskLassoCV    |       210318.64    |       360.70    |       0.15    |       -0.03        |                 
|       CatBoostRegressor    |       227234.51    |       380.61    |       0.16    |       -0.11       |                   
|       Xgboost    |       240423.04    |       388.45    |       0.16    |       -0.18 |                                
|       Blend_mean    |       214543.56    |       367.31    |       0.15    |       -0.05      |       

Блендинг моделей дал улучшение по признаку "Модуль упругости при растяжении, ГПа", но по признаку "Прочность при растяжении, МПа" он хуже, чем LassoCV.                                                 
В целом LassoCV показал себя лучше в решении поставленной задачи, чем остальные примененные методы машинного обучения.                                            

В предсказании признака "Соотношение матрица-наполнитель" с помощью нейронной сети получены следующие показатели метрик:
                                           
| model   |       MSE     |       MAE     |       MAPE    |       R2       |               
|:-------:|:-------------:|:-------------:|:-------------:|:--------------:|             
| NN      |       5.41    |       2.31    |       4.87    |       -199.67  |                               
 
 
### Приложение Flask
Разработано приложение на основе модели машинного обучения  MultiTaskLassoCV, с учетом необходимой нормализации.
                                              
### Выводы
- Изучены теоретические основы и методы решения поставленной задачи;
- Подготовлены данные для применения методов машинного обучения;
- Подобраны метрики для оценки эффективности модели при решении задач регрессии;
- Использованы методы машинного обучения для решения задач регрессии;
- Построена нейронная сеть на табличных данных;
- Разработано приложение для вывода модели в продакшн.


### Возможные пути улучшения решения
- Провести анализ ошибок моделей
- Использовать стекинг








